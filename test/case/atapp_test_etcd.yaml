# Copyright 2026 atframework
atapp:
  id: 0x00000701
  id_mask: 8.8.8.8
  name: "etcd-test-node"
  type_id: 7
  type_name: "etcd-test"

  bus:
    listen: "ipv4://127.0.0.1:22201"
    proxy: ""
    backlog: 256
    access_token_max_number: 5
    overwrite_listen_path: false
    topology:
      rule:
        allow_direct_connection: true
        require_same_upstream: false
    first_idle_timeout: 10s
    ping_interval: 60s
    retry_interval: 3s
    fault_tolerant: 3
    message_size: 64KB
    receive_buffer_size: 1MB
    send_buffer_size: 1MB
    send_buffer_number: 0
  timer:
    tick_interval: 8ms
    stop_timeout: 3s
    stop_interval: 256ms
  etcd:
    enable: true
    hosts:
      - "${ATAPP_UNIT_TEST_ETCD_HOST:-http://127.0.0.1:12379}"
    path: "/unit-test/libatapp"
    init:
      timeout: "15s"
      tick_interval: "64ms"
    keepalive:
      timeout: "16s"
      ttl: "5s"
      retry_interval: "3s"
    request:
      timeout: "5s"
      initialization_timeout: "3s"
    watcher:
      retry_interval: "3s"
      request_timeout: "3600s"
      get_request_timeout: "180s"

  log:
    level: debug
    category:
      - name: default
        prefix: "[Log %L][%F %T.%f][%s:%n(%C)]: "
        stacktrace:
          min: disable
          max: disable
        sink:
          - type: file
            level:
              min: fatal
              max: debug
            rotate:
              number: 10
              size: 10485760
            file: "../log/etcd-test-node.%N.log"
            writing_alias: "../log/etcd-test-node.log"
            auto_flush: info
            flush_interval: 1s
          - type: stderr
            level:
              min: fatal
              max: warning
          - type: stdout
            level:
              min: fatal
              max: debug
